<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="subject" content="VA Fileman v. 22.0 Programmer HTML manual">
    <meta name="keywords"
    content="information infrastructure service,iis,infrastructure and security services,infrastructure security services,iss,vista,fileman,va fileman,programmer,developer,programmer manual,advanced file definitions,file definitions,definitions,files">
    <meta name="author" value="Sam Habiel">
    <title>VA FileMan Programmer Manual: BUILDNEW^DIBTED</title>
    <link rel="stylesheet" type="text/css" href="programmer.css">
  </head>
  <body topmargin="0">
    <br><img src="common/fileman_pm_heading.gif" border="0" width="429" height="29"
  alt="va fileman v. 22.0 programmer manual banner">
  <br>
  <hr align="left" width="429" color="blue">
  <br>
  <p>&nbsp;</p>
<table border="0" width="100%" cellspacing="0" cellpadding="3"
    class="tdstyle" summary="this table is for formatting purposes only" height="1"
    valign="top">
    <tr>
      <td valign="bottom" align="left" height="1" width="10%"
      class="menubartext">Contents:</td>
      <td valign="bottom" align="left" height="1" width="7%">
       <a href="index.htm" target="_top"
        title="va fileman v. 22.0 programmer html manual: main table of contents"
        class="menubarlink">Main</a> </td>
      <td valign="bottom" align="left" height="1" width="17%"><a
       href="afd_frm.htm" target="_top"
       title="va fileman v. 22.0 programmer html manual: advanced file definition chapter toc"
       class="menubarlink">Chapter</a></td>
      <td align="left" valign="bottom" height="1" width="10%"
      class="menubartext">See Also: </td>
      <td align="left" valign="bottom" height="1" width="28%"><a
       href="../u1/index.htm" target="_top"
       title="va fileman v. 22.0 getting started html manual"
       class="menubarlink">Getting Started Manual</a></td>
      <td valign="bottom" align="left" height="1" colspan="4" width="28%">
       <a href="../u2/index.htm" target="_top"
        title="va fileman v. 22.0 advanced user html manual"
        class="menubarlink">Advanced User Manual</a></td>
    </tr>
   </table>
   <!-- content -->
   <h3><a name="navskip">Database Server (DBS) API</a></h3>
   <hr class="hrstyle">
   <h4>BUILDNEW^DIBTED: Sort Template Builder</h4>
   <p>
    This procedure creates an entry in the Sort Template file (#.401). The
    templates can be used for any purpose. However, you will primarily use this
    procedure with <code>LIST^DIC()</code>. The templates created “on-the-fly”
    by <code>BUILDNEW^DIBTED()</code>, can be used in <code>LIST^DIC()</code> in
    conjunction with the “X” flag to control the output of that procedure.
   </p>
   <h5>Format</h5>
<pre>
BUILDNEW^DIBTED(.return,file,sort_criteria,template_name)
</pre>
   <h5>Input Parameters</h5>
   <table class="parameters">
     <tr>
       <td>.return:</td>
       <td>
         <p>A variable, passed by reference, which will contain the result of
         the procedure call.</p>
         <p>Possible returned values are:</p>
         <ul>
          <li>-1—Indicating that the call failed, with no returned error
          message.</li>
          <li>-1^error—Indicating the call failed, with a returned error
          message.</li>
          <li>Template_IEN^Template_Name^1—Indicating that the call succeeded
          with a new entry in the Sort Template file at Template_IEN and with
          the name indicated. The name should be the Template Name passed into
          the procedure in the fourth parameter.</li>
          <li>Template_IEN^Template_Name—Indicating the call succeeded with an
          existing entry in the Sort Template file being overwritten with the
          new sort criteria. The Template Name passed into the procedure
          already existed in the Sort Template file.</li>
         </ul>
       </td>
     </tr>
     <tr>
       <td>file:</td>
       <td>Number of the file on which the sort template is created.</td>
     </tr>
     <tr>
        <td>sort_criteria:</td>
        <td>The name of the array containing the sort criteria. The array
        should be subscripted with positive numbers. The contents of the array
        must match exactly the format expected by the sort template engine. The
        best way for the developer to create the array is to make a sort
        template using the Print File Entries option and copy the array
        produced. The properly formatted elements of the array can be found
        using the Template Edit option on the second page of the screen mode
        form.</td>
     </tr>
     <tr>
        <td>template_name:</td>
        <td>The name you want to give the template. Do not include brackets. If
        a sort template with that name already exists, it will be over-written
        with the new sort criteria.</td>
     </tr>
   </table>
   <h5>Output</h5>
   <p>The primary output of this procedure is the creation of a new Sort
   Template. A description of the result of the call is returned in the .RESULT
   parameter as described above in the Input section.</p>
   <h5>Example</h5>
   <p>The following example illustrates the creation of a Sort Template using
   <code>BUILDNEW^DIBTED()</code>. Note the specific spacing in the nodes of
   SORT(). The RET variable returns the IEN of the entry in the Sort Template
   file (922) as well as the name of the new template, which is the same name
   passed into the procedure. The “1” in the third piece of RET indicates that
   a new template was created. The <code>LIST^DIC()</code>call makes us of the
   newly created template. Note: brackets are added to the Template Name for
   the Lister call.</p>
   <pre>
>S SORT(1)="SORT BY: -COUNT(COUNTY)"
>S SORT(2)="From:"
>S SORT(3)="To:"
>S SORT(4)=" WITHIN COUNT(COUNTY), SORT BY: $E(NAME,1,3)=""NEW""" >S FILE=5
>N RET
>S TNAME="ZZD STATE SORT 1"
>D BUILDNEW^DIBTED(.RET,FILE,$NA(SORT),TNAME)
>W RET
922^ZZD STATE SORT 1^1
>D LIST^DIC(FILE,,".01;COUNT(COUNTY)","X",,,,"[ZZD STATE SORT 1]")
   </pre>
   <hr class="hrstyle">
   <footer>Reviewed/Updated: August 21 2016</footer>
  </body>
</html>
