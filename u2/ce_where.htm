<!DOCTYPE HTML PUBLIC "-//SQ//DTD HTML 2.0 HoTMetaL + extensions//EN" "hmpro6.dtd">
<HTML> 
  <HEAD>

<!--VHA OI Health Systems Design & Development (HSD&D)-->
<!--Oakland OIFO-->
<!--Authored by Thom Blom and Kyle Clarke, 12/31/99-->
<!--Revised by Thom Blom, 06/27/03-->
<!--Edited March 2007, Hardhats.org-->
	 <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1"> 
	 <TITLE>VA FileMan V. 22.0 Advanced User Manual: On-the-Fly Computed
		Expressions</TITLE>
	 <META NAME="subject" CONTENT="VA FileMan V. 22.0 Advanced User HTML Manual">
	 <META NAME="keywords"
	  CONTENT="information infrastructure service,iis,Infrastructure and Security Services,Infrastructure Security Services,ISS,vista,fileman,va fileman,user,advanced user manual,computed expressions,computed,expressions,on-the-fly, on the fly, word-processing windows,windows,word processing,stuffing,output transforms,transforms">
	 <LINK REL="StyleSheet" TYPE="text/css" HREF="user.css"> 
  </HEAD> 
  <BODY BGCOLOR="white" TOPMARGIN="0">
	<BR><IMG SRC="common/fileman_au_heading.gif" BORDER="0" WIDTH="429" HEIGHT="29"
	ALT="VA FileMan V. 22.0 Getting Started HTML Manual Banner">
	<BR>
	<HR ALIGN="left" WIDTH="429" COLOR="blue">
	<BR>
	<P>&nbsp;</P>
	<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLPADDING="3"
	  CLASS="tdstyle" SUMMARY="This table is for formatting purposes only" HEIGHT="1"
	  VALIGN="TOP"> 
		<TR> 
		  <TD VALIGN="BOTTOM" ALIGN="LEFT" HEIGHT="1" WIDTH="10%"
			CLASS="menubartext">Contents:</TD> 
		  <TD VALIGN="BOTTOM" ALIGN="LEFT" HEIGHT="1" WIDTH="7%">
			 <A HREF="index.htm" TARGET="_top"
			  TITLE="VA FileMan V. 22.0 Advanced User HTML Manual: Main Table of Contents"
			  CLASS="menubarlink">Main</A> </TD> 
		  <TD VALIGN="BOTTOM" ALIGN="LEFT" HEIGHT="1" WIDTH="17%"><A
			 HREF="ce_frm.htm" TARGET="_top"
			 TITLE="VA FileMan V. 22.0 Advanced User HTML Manual: Computed Exptressions Chapter TOC"
			 CLASS="menubarlink">Chapter</A></TD> 
		  <TD ALIGN="LEFT" VALIGN="BOTTOM" HEIGHT="1" WIDTH="10%"
			CLASS="menubartext">See Also: </TD> 
		  <TD ALIGN="LEFT" VALIGN="BOTTOM" HEIGHT="1" WIDTH="28%"><A
			 HREF="../u1/index.htm" TARGET="_top"
			 TITLE="VA FileMan V. 22.0 Getting Started HTML Manual"
			 CLASS="menubarlink">Getting Started Manual</A></TD> 
		  <TD VALIGN="BOTTOM" ALIGN="LEFT" HEIGHT="1" COLSPAN="4" WIDTH="28%">
			 <A HREF="../pm/index.htm" TARGET="_top"
			  TITLE="VA FileMan V. 22.0 Programmer HTML Manual"
			  CLASS="menubarlink">Programmer Manual</A></TD> 
		</TR> 
	 </TABLE><!-- Content -->
	 <H3><A NAME="navskip">Computed Expressions</A></H3> <HR CLASS="hrstyle"> 
	 <H4>Where to Use Computed Expressions "On-the-Fly"</H4> 
	 <P><B>"On-the-Fly" Computed Expressions</B> </P> 
	 <P>In addition to permanently storing a computed expression in a data
		dictionary, there are several places within VA FileMan's dialogue where you can
		use a computed expression "<B>on-the-fly</B>:"</P> 
	 <UL> 
		<LI><A HREF="#Print" TITLE='"PRINT FIELD:" Prompt'
		  CLASS="bodylink">"PRINT FIELD:" Prompt</A><BR><BR></LI> 
		<LI><A HREF="#Search" TITLE='"SEARCH FOR FIELD:" Prompt'
		  CLASS="bodylink">"SEARCH FOR FIELD:" Prompt</A><BR><BR></LI> 
		<LI><A HREF="#Sort" TITLE='"SORT BY:" Prompt' CLASS="bodylink">"SORT BY:"
		  Prompt</A><BR><BR></LI> 
		<LI><A HREF="#Default" TITLE="Field Value Stuffing"
		  CLASS="bodylink">Field Value Stuffing</A><BR><BR></LI> 
		<LI><A HREF="#Output" TITLE="OUTPUT Transforms" CLASS="bodylink">OUTPUT
		  Transforms</A><BR><BR></LI> 
		<LI><A HREF="#Wp" TITLE="Word-processing Windows (| | )"
		  CLASS="bodylink">Word-processing Windows (<B>| |</B>)</A></LI> 
	 </UL> <HR> 
	 <H5><A NAME="Print">"PRINT FIELD:" Prompt</A></H5> 
	 <P>Whenever, you are within the Print or Search File Entries options, you
		are asked:</P> 
	 <PRE>    FIRST PRINT FIELD:</PRE> 
	 <P> OR </P> 
	 <PRE>    THEN PRINT FIELD:</PRE> 
	 <P>You can answer with a computed expression. For example: </P> 
	 <PRE>    FIRST PRINT FIELD: <B>SEX_&quot; &quot;_RELIGION;&quot;&quot;;L33</B></PRE> 
	 <P>This computed expression will return the contents of the SEX and
		RELIGION fields separated by a space. Notice that you can follow the computed
		expression with print qualifiers: <B>;""</B> to suppress the column heading and
		<B>;L33</B> to indicate that the COMPUTED field length can be 33 characters
		long. </P> 
	 <P>A user with programmer access can also enter M code at this prompt. The
		M code must have a WRITE statement for anything that is to be written to the
		report.</P> <HR> 
	 <H5><A NAME="Search">"SEARCH FOR FIELD:" Prompt</A></H5> 
	 <P>In the Search File Entries option, you can answer the</P> 
	 <PRE>    SEARCH FOR FIELD:</PRE> 
	 <P>prompt with a computed expression. </P> 
	 <P>If the expression is Boolean (i.e., its value is either true or false),
		you won't be asked the condition of the search, because the computed expression
		itself specifies that condition. </P> 
	 <P>A user with programmer access can also enter M code at this prompt. The
		M code must set the variable X to whatever is to be compared against the search
		value.</P> <HR> 
	 <H5><A NAME="Sort">"SORT BY:" Prompt</A></H5> 
	 <P>In Print or Search File Entries options, you can answer the</P> 
	 <PRE>    SORT BY:</PRE> 
	 <P>prompt with a computed expression. If you use a Boolean computed
		expression, you won't be asked for the "START WITH" parameters. </P> 
	 <P>A user with programmer access can also enter M code at this prompt. The
		M code must set the variable X to the sort value.</P> 
	 <P>Thus, if you want to print a list of the names of all patients who are
		Baptists, you could enter: </P> 
	 <PRE></PRE> <HR> 
	 <PRE>Select OPTION: <B>PR</B>INT FILE ENTRIES 

OUTPUT FROM WHAT FILE: <B>PATIENT</B>  
SORT BY: <B>RELIGION=&quot;BAPTIST&quot; </B>
   WITHIN RELIGION=&quot;BAPTIST&quot;, SORT BY: <B>&lt;RET&gt;</B>
FIRST PRINT FIELD: <B>NAME</B> </PRE> <HR> 
	 <P>This is a common way to select certain records for printing. </P> <HR> 
	 <H5><A NAME="Default">Field Value Stuffing</A></H5> 
	 <P>In the Enter or Edit File Entries option, you can follow the <B>//</B>
		or <B>///</B> specifiers with computed expressions. The expression is evaluated
		for the entry you are inputting and used as a
		<A HREF="e3_intro.htm#defaults_variable" TITLE="variable stuff"
		CLASS="bodylink">variable stuff</A> value. </P> 
	 <P>Suppose you want to put the current contents of a patient's NEXT OF KIN
		field into the BENEFICIARY field, with a notation that this value is
		UNVERIFIED, for all patients who don't have a value in the BENEFICIARY field.
		The dialogue would look like this: </P> 
	 <PRE></PRE> <HR> 
	 <PRE>Select OPTION: <B>ENT</B>ER OR EDIT FILE ENTRIES
INPUT TO WHAT FILE: <B>PATIENT</B> 
EDIT WHICH FIELD: <B>BENEFICIARY///NEXT OF KIN_&quot; (UNVERIFIED)&quot;</B>
THEN EDIT FIELD: <B>&lt;RET&gt;</B>

Select PATIENT NAME: <B>^LOOP</B> 
    EDIT ENTRIES BY: <B>BENEFICIARY=&quot;&quot;</B> 
 WITHIN BENEFICIARY=&quot;&quot;, EDIT ENTRIES BY: <B>&lt;RET&gt;</B></PRE> <HR> 
	 <P>This example uses two "on the fly" expressions: one in answer to the
		"EDIT ENTRIES BY:" prompt (which is essentially a SORT BY for
		<A HREF="e3_intro.htm#looping" TITLE="looping" CLASS="bodylink">looping</A>)
		and one as the forced default value for the BENEFICIARY input field. </P> 
	 <P>BENEFICIARY="" is a Boolean (True/False) computed expression that means
		"The BENEFICIARY value equals null."</P> 
	 <P>After the previous dialogue, the names of such patients would be printed
		out, and their BENEFICIARY value would automatically be set equal to their NEXT
		OF KIN field value, concatenated with a space followed by "(UNVERIFIED)." </P>
	 <HR> 
	 <H5><A NAME="Output">OUTPUT Transforms</A></H5> 
	 <P>OUTPUT transforms change the way a field is displayed when printed.
		Frequently, the OUTPUT transform will contain a computed expression that alters
		the data stored internally in the field. A simple OUTPUT transform that
		converts the internally stored date into MM/DD/YY format is: </P> 
	 <PRE>    DATE OF BIRTH OUTPUT TRANSFORM: <B>NUMDATE(DATE OF BIRTH)</B></PRE> 
	 <P>If an OUTPUT transform is applied to a field, the result of the
		transform will be used if that field is used in another computed expression.
		For example, if DATE OF BIRTH is used in a PRINT template, the "transformed"
		value will be output:</P> 
	 <PRE>    THEN PRINT FIELD: <B>NAME_&quot;'S BIRTHDAY: &quot;_DATE OF BIRTH</B></PRE> 
	 <P>The result of this computed expression would be similar to: </P> 
	 <PRE>    JOHN DOE'S BIRTHDAY: 03/07/42</PRE> <HR> 
	 <H5><A NAME="Wp">Word-processing Windows (| |)</A></H5> 
	 <P>When entering text into a field with a WORD-PROCESSING Data Type, you
		can insert a computed expression within a <B>|Window|</B>. This expression will
		be evaluated at the time the WORD-PROCESSING-type field is printed. If the
		expression is meaningful, its value will replace the <B>|Window|</B> in the
		printed output. </P> 
	 <P>For example, you could embed within the text of the HISTORY
		WORD-PROCESSING-type field a <B>|Window|</B> containing a COMPUTED field
		expression: </P> 
	 <PRE>    HISTORY:  
    1&gt; <B>PATIENT IS A |SEX_&quot; &quot;_RELIGION| WHO HAS NO</B>
    2&gt; <B>APPARENT PROBLEMS.</B></PRE> 
	 <P>When this field is printed for a patient who has a SEX value of MALE and
		a RELIGION value of CATHOLIC, the output would look like: </P> 
	 <PRE>    PATIENT IS A MALE CATHOLIC WHO HAS NO 
    APPARENT PROBLEMS.</PRE> 
	 <P>&nbsp;</P> 
	 <HR CLASS="hrstyle">
	 <!-- ce_where.htm -->
	 <P ALIGN="CENTER">Reviewed/Updated: March 4, 2007</P>
	 <P>&nbsp;</P> 

  </BODY>
</HTML>
