<!DOCTYPE HTML PUBLIC "-//SQ//DTD HTML 2.0 HoTMetaL + extensions//EN" "hmpro6.dtd">
<HTML> 
  <HEAD><!--VHA OI Health Systems Design & Development (HSD&D)-->
<!--Oakland OIFO-->
<!--Authored by Thom Blom and Kyle Clarke, 12/31/99-->
<!--Revised by Thom Blom, 06/27/03-->
<!--Edited March 2007, Hardhats.org-->
	 <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1"> 
	 <TITLE>VA FileMan V. 22.0 Advanced User Manual: Extract Tool Create Extract
		Template Option</TITLE>
	 <META NAME="subject" CONTENT="VA FileMan V. 22.0 Advanced User HTML Manual">
	 <META NAME="keywords"
	  CONTENT="information infrastructure service,iis,Infrastructure and Security Services,Infrastructure Security Services,ISS,vista,fileman,va fileman,user,advanced user manual,extract tool,tools,extract,step 5,create extract template option">
	 <LINK REL="StyleSheet" TYPE="text/css" HREF="user.css"> 
  </HEAD> 
  <BODY BGCOLOR="white" TOPMARGIN="0">
	<BR><IMG SRC="common/fileman_au_heading.gif" BORDER="0" WIDTH="429" HEIGHT="29"
	ALT="VA FileMan V. 22.0 Getting Started HTML Manual Banner">
	<BR>
	<HR ALIGN="left" WIDTH="429" COLOR="blue">
	<BR>
	<P>&nbsp;</P>
	<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLPADDING="3"
	  CLASS="tdstyle" SUMMARY="This table is for formatting purposes only" HEIGHT="1"
	  VALIGN="TOP"> 
		<TR> 
		  <TD VALIGN="BOTTOM" ALIGN="LEFT" HEIGHT="1" WIDTH="10%"
			CLASS="menubartext">Contents:</TD> 
		  <TD VALIGN="BOTTOM" ALIGN="LEFT" HEIGHT="1" WIDTH="7%">
			 <A HREF="index.htm" TARGET="_top"
			  TITLE="VA FileMan V. 22.0 Advanced User HTML Manual: Main Table of Contents"
			  CLASS="menubarlink">Main</A> </TD> 
		  <TD VALIGN="BOTTOM" ALIGN="LEFT" HEIGHT="1" WIDTH="17%"><A
			 HREF="ex_frm.htm" TARGET="_top"
			 TITLE="VA FileMan V. 22.0 Advanced User HTML Manual: Extract Tool Chapter TOC"
			 CLASS="menubarlink">Chapter</A></TD> 
		  <TD ALIGN="LEFT" VALIGN="BOTTOM" HEIGHT="1" WIDTH="10%"
			CLASS="menubartext">See Also: </TD> 
		  <TD ALIGN="LEFT" VALIGN="BOTTOM" HEIGHT="1" WIDTH="28%"><A
			 HREF="../u1/index.htm" TARGET="_top"
			 TITLE="VA FileMan V. 22.0 Getting Started HTML Manual"
			 CLASS="menubarlink">Getting Started Manual</A></TD> 
		  <TD VALIGN="BOTTOM" ALIGN="LEFT" HEIGHT="1" COLSPAN="4" WIDTH="28%">
			 <A HREF="../pm/index.htm" TARGET="_top"
			  TITLE="VA FileMan V. 22.0 Programmer HTML Manual"
			  CLASS="menubarlink">Programmer Manual</A></TD> 
		</TR> 
	 </TABLE><!-- Content -->
	 <H3><A NAME="navskip">Extract Tool</A></H3> <HR CLASS="hrstyle"> 
	 <H4>Create Extract Template Option (5 of 9)</H4> 
	 <P>When selecting destination fields for data to be extracted into, keep in
		mind that the INPUT transforms of the destination fields are executed for each
		field value. For an extracted record, the value of each field in the record is
		tested against the INPUT transform of its destination field. If any field fails
		the INPUT transform, the extract for the entire record will fail. Make sure the
		INPUT transforms on the destination fields are appropriate for the data you
		will be extracting. </P> 
	 <P><B>NOTE:</B> If you are extracting a <B>Sub</B>record using the
		EXTRACT^DIAXU entry point and its FILING_LEVEL parameter, and a value fails the
		INPUT transform, only the extract of the Subrecord will fail.</P> 
	 <P>When you are ready to build an EXTRACT template, you must select the
		Create Extract Template option. Using this option, you will identify not only
		the field you wish to extract from the
		<A HREF="ex_src.htm" TITLE="source file" CLASS="bodylink">source file</A> but
		also its corresponding field in the
		<A HREF="ex_dest.htm" TITLE="destination file" CLASS="bodylink">destination
		file</A>. The EXTRACT template is the only type of PRINT template used in the
		<A HREF="ex_opt6.htm" TITLE="Update Destination File" CLASS="bodylink">Update
		Destination File</A> option. </P> 
	 <P>Building an EXTRACT template requires entering valid field numbers or
		field names at the "EXTRACT FIELD" prompt. Since VA FileMan stores EXTRACT
		templates in the PRINT TEMPLATE file (#.4), this option uses the term "PRINT
		TEMPLATE" instead of "EXTRACT TEMPLATE" in the dialogue. For each extract field
		that you identify in the source file, at the "MAP TO" field prompt, enter the
		destination file field name or field number that will receive the data. Only
		those fields defined in the EXTRACT template will appear in the destination
		file. </P> 
	 <P>Keep in mind that the value of each field in an extracted record is
		tested against the INPUT transform of its destination field. If any value fails
		its destination field's INPUT transform, the extract for the entire record will
		fail. Make sure the INPUT transforms on the destination fields are appropriate
		for the data you will be extracting. </P> 
	 <P><B>NOTE:</B> If you are extracting a <B>Sub</B>record using the
		EXTRACT^DIAXU entry point and its FILING_LEVEL parameter, and a value fails the
		INPUT transform, only the extract of the Subrecord will fail.</P> 
	 <P>When you arrive at the "STORE EXTRACT LOGIC IN TEMPLATE:" prompt, enter
		the name that you wish to assign to your new EXTRACT template. To edit an
		existing EXTRACT template, on the other hand, simply enter its name at the
		"FIRST EXTRACT FIELD:" prompt -- using the following format: </P> 
	 <PRE>
  <B>    &quot;[Extract templatename&quot;</B></PRE> 
	 <P>Here is a sample of the dialogue that you will encounter when you are
		ready to build an EXTRACT template: </P> 
	  
	 <PRE>Select EXTRACT OPTION:  <B>CREATE</B> EXTRACT TEMPLATE
 
This option lets you build a template where you specify fields to extract and
their corresponding mapping in the destination file. 

For more detailed description of requirements on the destination file, please
see your VA FileMan User Manual.

OUTPUT FROM WHAT FILE: <B>CHANGE </B>  (956 entries)
DESTINATION FILE: <B>CHANGE EXTRACT </B>  (0 entries)

FIRST EXTRACT CHANGE FIELD: <B>.01 </B>  NO.
MAP NO. TO CHANGE EXTRACT FIELD: <B>.01 </B>  NO.

 THEN EXTRACT CHANGE FIELD: <B>VERSION</B>
 MAP VERSION TO CHANGE EXTRACT FIELD: <B>VERSION</B>

 THEN EXTRACT CHANGE FIELD: <B>PROGRAMMER</B>
 MAP PROGRAMMER TO CHANGE EXTRACT FIELD: <B>PROGRAMMER</B>

STORE EXTRACT LOGIC IN TEMPLATE: <B>CHANGE EXTRACT</B>
  Are you adding 'CHANGE EXTRACT' as a new PRINT TEMPLATE?  No// <B>YES </B>  (Yes)</PRE> <HR> 
	 <P>While you are creating your EXTRACT template, VA FileMan performs a few
		validation checks. Inspecting the extract field and its corresponding field in
		the destination file, VA FileMan checks to see if both fields are compatible in
		several important areas, including Data Type, minimum length, maximum length,
		minimum values, maximum values. </P> 
	 <P>If a discrepancy exists, VA FileMan will display an error message such
		as the following statement: </P> 
	 <PRE>    PROGRAMMER field in CHANGE EXTRACT file should have a maximum 
    length of at least 30 characters.</PRE> 
	 <P>After VA FileMan displays an error message about your destination field,
		you can continue building your template. You will not, however, be able to
		update the destination file until you have corrected the problem. </P> 
	 <P>Here is the warning that you will see when any source field and its
		corresponding destination field fail one of the validation checks:</P> 
	 <PRE>    THE DESTINATION FILE DATA DICTIONARY SHOULD BE MODIFIED PRIOR TO 
    ANY MOVEMENT OF EXTRACT DATA! 
</PRE> 
	 <P>At any "MAP 'FIELD NAME' TO 'FILE NAME' FIELD:" prompt, entering two
		question marks (" <B>??</B>") yields a list of the selectable fields in the
		destination file. The list gets shorter as fields are selected to ensure that
		no two extract fields map information to a single field in the destination
		file. </P>
	 <P>&nbsp;</P> 
	 <HR CLASS="hrstyle">
	 <!-- ex_opt5.htm -->
	 <P ALIGN="CENTER">Reviewed/Updated: March 4, 2007</P>
	 <P>&nbsp;</P> 

  </BODY>
</HTML>
